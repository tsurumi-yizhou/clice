import{_ as s,c as i,o as a,ae as t}from"./chunks/framework.l7bN90nj.js";const u=JSON.parse('{"title":"Construire à partir des sources","description":"","frontmatter":{},"headers":[],"relativePath":"fr/dev/build.md","filePath":"fr/dev/build.md"}'),n={name:"fr/dev/build.md"};function l(r,e,o,p,d,c){return a(),i("div",null,[...e[0]||(e[0]=[t(`<h1 id="construire-a-partir-des-sources" tabindex="-1">Construire à partir des sources <a class="header-anchor" href="#construire-a-partir-des-sources" aria-label="Permalink to &quot;Construire à partir des sources&quot;">​</a></h1><p>clice dépend des fonctionnalités de C++23 et nécessite une chaîne d’outils C++ moderne. Nous devons également effectuer l’édition de liens avec LLVM/Clang pour analyser les AST. Pour accélérer les constructions, la configuration par défaut télécharge notre paquet précompilé <a href="https://github.com/clice-io/clice-llvm" target="_blank" rel="noreferrer">clice-llvm</a>. Cela suppose que votre environnement local corresponde étroitement à l’environnement de précompilation (en particulier lors de l’activation de l’Address Sanitizer ou de l’LTO).</p><p>Pour simplifier la configuration et garantir la reproductibilité des constructions, nous <strong>recommandons fortement</strong> <a href="https://pixi.prefix.dev/latest" target="_blank" rel="noreferrer">pixi</a> pour administrer l’environnement de développement. Les versions des dépendances sont figées dans <code>pixi.toml</code>.</p><p>Si vous préférez ne pas utiliser pixi, consultez la section <a href="#construction-manuelle">Construction Manuelle</a> ci-dessous.</p><h2 id="demarrage-rapide" tabindex="-1">Démarrage Rapide <a class="header-anchor" href="#demarrage-rapide" aria-label="Permalink to &quot;Démarrage Rapide&quot;">​</a></h2><p>Installez pixi en suivant le <a href="https://pixi.prefix.dev/latest/installation" target="_blank" rel="noreferrer">guide officiel</a>.</p><p>Nous proposons plusieurs tâches ; les commandes ci-dessous configurent, construisent et lancent les tests :</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># configurer &amp;&amp; construire (par défaut RelWithDebInfo)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pixi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># tests unitaires &amp;&amp; d’intégration</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pixi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test</span></span></code></pre></div><p>Pour des tâches plus précises (le premier argument définit le type de construction) :</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pixi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cmake-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Debug</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pixi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cmake-build</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Debug</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pixi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> unit-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Debug</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pixi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> integration-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Debug</span></span></code></pre></div><div class="tip custom-block github-alert"><p class="custom-block-title">TIP</p><p>Si vous souhaitez développer directement avec <code>cmake</code>, <code>ninja</code>, <code>clang++</code>, etc., lancez <code>pixi shell</code> pour entrer dans un shell où toutes les variables d’environnement sont configurées.</p></div><h3 id="xmake" tabindex="-1">XMake <a class="header-anchor" href="#xmake" aria-label="Permalink to &quot;XMake&quot;">​</a></h3><p>Nous prenons également en charge la construction avec XMake :</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># config &amp; build (par défaut releasedbg)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pixi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xmake</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># tests unitaires &amp; d’intégration</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pixi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xmake-test</span></span></code></pre></div><h2 id="construction-manuelle" tabindex="-1">Construction Manuelle <a class="header-anchor" href="#construction-manuelle" aria-label="Permalink to &quot;Construction Manuelle&quot;">​</a></h2><p>Si vous prévoyez de construire manuellement, assurez-vous d’abord que votre chaîne d’outils correspond aux versions définies dans <code>pixi.toml</code>.</p><blockquote><p>Compatibilité : En théorie, clice ne dépend pas d’extensions spécifiques au compilateur, donc les compilateurs grand public (GCC/Clang/MSVC) devraient fonctionner. Cependant, l’intégration continue (CI) ne garantit que des versions spécifiques de Clang. Les autres compilateurs ou versions sont pris en charge au <strong>mieux possible</strong>. Veuillez ouvrir une issue ou une PR si vous rencontrez des problèmes.</p></blockquote><h3 id="cmake" tabindex="-1">CMake <a class="header-anchor" href="#cmake" aria-label="Permalink to &quot;CMake&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cmake</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -B</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -G</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Ninja</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    -DCMAKE_BUILD_TYPE=RelWithDebInfo</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain.cmake</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    -DCLICE_ENABLE_TEST=ON</span></span></code></pre></div><blockquote><p>Note : <code>CMAKE_TOOLCHAIN_FILE</code> est optionnel. Si votre chaîne d’outils correspond exactement à la nôtre, vous pouvez utiliser le fichier <code>cmake/toolchain.cmake</code> prédéfini ; sinon, retirez ce drapeau.</p></blockquote><p>Options de construction optionnelles :</p><table tabindex="0"><thead><tr><th>Option</th><th>Défaut</th><th>Effet</th></tr></thead><tbody><tr><td>LLVM_INSTALL_PATH</td><td>&quot;&quot;</td><td>Construire clice avec LLVM depuis un chemin personnalisé</td></tr><tr><td>CLICE_ENABLE_TEST</td><td>OFF</td><td>Construire les tests unitaires de clice</td></tr><tr><td>CLICE_USE_LIBCXX</td><td>OFF</td><td>Construire clice avec libc++ (ajoute <code>-std=libc++</code>) ; si activé, assurez-vous que les libs LLVM sont aussi construites avec libc++</td></tr><tr><td>CLICE_CI_ENVIRONMENT</td><td>OFF</td><td>Activer la macro <code>CLICE_CI_ENVIRONMENT</code> ; certains tests ne s’exécutent qu’en CI</td></tr></tbody></table><h3 id="xmake-1" tabindex="-1">XMake <a class="header-anchor" href="#xmake-1" aria-label="Permalink to &quot;XMake&quot;">​</a></h3><p>Construisez clice avec :</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">xmake</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> f</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --mode=releasedbg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --toolchain=clang</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">xmake</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --all</span></span></code></pre></div><p>Options de construction optionnelles :</p><table tabindex="0"><thead><tr><th>Option</th><th>Défaut</th><th>Effet</th></tr></thead><tbody><tr><td>--llvm</td><td>&quot;&quot;</td><td>Construire clice avec LLVM depuis un chemin personnalisé</td></tr><tr><td>--enable_test</td><td>false</td><td>Construire les tests unitaires de clice</td></tr><tr><td>--ci</td><td>false</td><td>Activer <code>CLICE_CI_ENVIRONMENT</code></td></tr></tbody></table><h2 id="a-propos-de-llvm" tabindex="-1">À propos de LLVM <a class="header-anchor" href="#a-propos-de-llvm" aria-label="Permalink to &quot;À propos de LLVM&quot;">​</a></h2><p>clice appelle les API Clang pour analyser le code C++, il doit donc être lié à LLVM/Clang. Comme clice utilise des en-têtes privés de Clang (généralement absents des paquets de distribution), le paquet LLVM du système ne peut pas être utilisé directement.</p><p>Deux façons de satisfaire cette dépendance :</p><ol><li>Nous publions des binaires précompilés de la version de LLVM que nous utilisons sur <a href="https://github.com/clice-io/clice-llvm/releases" target="_blank" rel="noreferrer">clice-llvm</a> pour la CI et les versions de sortie. Lors des constructions, cmake et xmake téléchargent ces bibliothèques LLVM par défaut.</li></ol><div class="important custom-block github-alert"><p class="custom-block-title">IMPORTANT</p><p></p><blockquote><p>Pour les constructions LLVM en mode debug, nous activons l’Address Sanitizer, qui dépend de compiler-rt et est très sensible à la version du compilateur. Si vous utilisez une construction debug, assurez-vous que votre version de clang compiler-rt correspond à celle définie dans <code>pixi.toml</code>.</p></blockquote></div><ol start="2"><li>Construisez LLVM/Clang vous-même pour correspondre à votre environnement. Si les binaires précompilés par défaut échouent en raison d’une inadéquation de l’ABI ou des versions de bibliothèques, ou si vous avez besoin d’une construction debug personnalisée, utilisez cette approche. Nous fournissons <code>scripts/build-llvm.py</code> pour construire les bibliothèques LLVM requises, ou reportez-vous au guide officiel de LLVM <a href="https://llvm.org/docs/CMake.html" target="_blank" rel="noreferrer">Building LLVM with CMake</a>.</li></ol>`,33)])])}const k=s(n,[["render",l]]);export{u as __pageData,k as default};
